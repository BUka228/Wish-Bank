# üéØ –ë–∞–Ω–∫ –ñ–µ–ª–∞–Ω–∏–π

MVP —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ–ª–∞–Ω–∏—è–º–∏ –¥–ª—è –ø–∞—Ä —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ Telegram.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üíö **–ó–µ–ª–µ–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è** - –ø—Ä–æ—Å—Ç—ã–µ, –±—ã—Å—Ç—Ä—ã–µ (1 –±–∞–ª–ª)
- üíô **–°–∏–Ω–∏–µ –∂–µ–ª–∞–Ω–∏—è** - —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (10 –∑–µ–ª–µ–Ω—ã—Ö = 1 —Å–∏–Ω–µ–µ)
- ‚ù§Ô∏è **–ö—Ä–∞—Å–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è** - —Å–ª–æ–∂–Ω—ã–µ, —Ü–µ–Ω–Ω—ã–µ (10 —Å–∏–Ω–∏—Ö = 1 –∫—Ä–∞—Å–Ω–æ–µ)
- üîÑ **–°–∏—Å—Ç–µ–º–∞ –æ–±–º–µ–Ω–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∫—É—Ä—Å–∞
- üì± **Telegram Mini App** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä
- üéÅ **–ë—ã—Å—Ç—Ä—ã–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è** - –¥–∞—Ç—å –∂–µ–ª–∞–Ω–∏–µ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫
- üìä **–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** - –ø–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Frontend**: Next.js 14, React, Tailwind CSS
- **Backend**: Vercel Functions (Serverless)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: Vercel Postgres
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: Telegram Bot API, Telegram Mini Apps
- **–•–æ—Å—Ç–∏–Ω–≥**: Vercel (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone <your-repo>
cd wish-bank
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env.local`:

```env
POSTGRES_URL=your_vercel_postgres_url
TELEGRAM_BOT_TOKEN=your_bot_token
VERCEL_URL=your_vercel_app_url
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞: `/newbot`
3. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env.local`
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook: `/setwebhook`

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Vercel Postgres

1. –ó–∞–π–¥–∏—Ç–µ –≤ [Vercel Dashboard](https://vercel.com/dashboard)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö Postgres
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `POSTGRES_URL` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 5. –î–µ–ø–ª–æ–π

```bash
# –î–µ–ø–ª–æ–π –Ω–∞ Vercel
vercel --prod

# –ò–ª–∏ —á–µ—Ä–µ–∑ GitHub
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Vercel –¥–ª—è –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è
```

### 6. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ß–µ—Ä–µ–∑ curl
curl -X POST https://your-app.vercel.app/api/init

# –ò–ª–∏ —á–µ—Ä–µ–∑ Node.js —Å–∫—Ä–∏–ø—Ç
VERCEL_URL=https://your-app.vercel.app node scripts/init-db.js
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
wish-bank/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                 # Next.js App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx      # Layout
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ globals.css     # –°—Ç–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ components/         # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BalanceCard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ QuickActions.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ WishCard.tsx
‚îÇ   ‚îú‚îÄ‚îÄ lib/               # –£—Ç–∏–ª–∏—Ç—ã –∏ –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.ts          # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telegram.ts    # Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ pages/api/         # API Routes
‚îÇ       ‚îú‚îÄ‚îÄ init.ts        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îÇ       ‚îú‚îÄ‚îÄ users/         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ       ‚îú‚îÄ‚îÄ wishes/        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–µ–ª–∞–Ω–∏—è–º–∏
‚îÇ       ‚îú‚îÄ‚îÄ transactions.ts # –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ exchange.ts    # –û–±–º–µ–Ω –∂–µ–ª–∞–Ω–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ telegram/      # Telegram webhook
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ vercel.json           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vercel
‚îî‚îÄ‚îÄ README.md
```

## API Endpoints

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `POST /api/users/init` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
- `GET /api/users` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ñ–µ–ª–∞–Ω–∏—è
- `GET /api/wishes` - –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è
- `POST /api/wishes` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∂–µ–ª–∞–Ω–∏–µ
- `POST /api/wishes/[id]/complete` - –í—ã–ø–æ–ª–Ω–∏—Ç—å –∂–µ–ª–∞–Ω–∏–µ

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `GET /api/transactions?userId=...` - –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- `POST /api/transactions` - –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (–Ω–∞—á–∏—Å–ª–∏—Ç—å/—Å–ø–∏—Å–∞—Ç—å)

### –û–±–º–µ–Ω
- `POST /api/exchange` - –û–±–º–µ–Ω—è—Ç—å –∂–µ–ª–∞–Ω–∏—è

### Telegram
- `POST /api/telegram/webhook` - Webhook –¥–ª—è –±–æ—Ç–∞

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

**users** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `id` (UUID, PK)
- `telegram_id` (VARCHAR, UNIQUE)
- `name`, `username`
- `green_balance`, `blue_balance`, `red_balance`
- `created_at`, `updated_at`

**wishes** - –ñ–µ–ª–∞–Ω–∏—è
- `id` (UUID, PK)
- `type` (green|blue|red)
- `description`, `status`
- `author_id`, `assignee_id` (FK users)
- `created_at`, `completed_at`

**transactions** - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `id` (UUID, PK)
- `user_id` (FK users)
- `type` (credit|debit)
- `wish_type`, `amount`, `reason`
- `created_at`

## –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

### –ì–æ—Ç–æ–≤—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- **–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π** - –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `achievements`
- **–ö–≤–µ—Å—Ç—ã –∏ —á–µ–ª–ª–µ–Ω–¥–∂–∏** - —Ä–∞—Å—à–∏—Ä–∏—Ç—å `wishes` –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** - –¥–æ–±–∞–≤–∏—Ç—å `events` —Å –±–æ–Ω—É—Å–∞–º–∏
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —Ä–∞—Å—à–∏—Ä–∏—Ç—å Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ endpoints
- **–ì–∏–±–∫–∞—è —Å—Ö–µ–º–∞ –ë–î** - JSONB –ø–æ–ª—è –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- **–°–æ–±—ã—Ç–∏–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ webhook'–∞–º –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º
- **Serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ö–æ–º–∞–Ω–¥—ã Telegram –±–æ—Ç–∞

- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∫–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `/help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/balance` - –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å
- `/give @username green|blue|red` - –î–∞—Ç—å –∂–µ–ª–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `/wishes` - –ü–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è
- `/exchange green|blue` - –û–±–º–µ–Ω—è—Ç—å –∂–µ–ª–∞–Ω–∏—è

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev

# –°–±–æ—Ä–∫–∞
npm run build

# –õ–∏–Ω—Ç–∏–Ω–≥
npm run lint
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–∫ —Ö–æ—Ç–∏—Ç–µ! üéâ
## –£—Å—Ç—Ä
–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è @nikirO1

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel
2. –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   node scripts/check-vercel-env.js
   ```

2. **–û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Vercel:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Vercel Dashboard ‚Üí Your Project ‚Üí Settings ‚Üí Environment Variables
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
     - `TELEGRAM_BOT_TOKEN` - —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
     - `ADMIN_TELEGRAM_ID=507387437` - Telegram ID @nikirO1
     - `DATABASE_URL` - —Ä–µ–∞–ª—å–Ω—ã–π URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Neon

3. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
   ```bash
   DATABASE_URL="your_production_url" node scripts/run-production-migrations.js
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥–º–∏–Ω—Å–∫–∏–π –¥–æ—Å—Ç—É–ø:**
   ```bash
   node scripts/check-admin-access.js
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "relation in_app_notifications does not exist"

**–†–µ—à–µ–Ω–∏–µ:**
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
DATABASE_URL="your_production_url" node scripts/run-production-migrations.js
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "invalid input syntax for type uuid"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–∏—Å—Ç–µ–º–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram ID –∫–∞–∫ UUID

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @nikirO1 –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–∞–∑
2. –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –∑–∞–ø–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º UUID
3. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∞–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. **–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∏ —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ:**
   ```bash
   vercel --prod
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   vercel logs
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   vercel env ls
   ```